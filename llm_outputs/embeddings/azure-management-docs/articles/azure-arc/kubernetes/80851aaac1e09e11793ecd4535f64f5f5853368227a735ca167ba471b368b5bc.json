{
  "data": {
    "content": "### Generic cluster where no reconciler is running on the `apiserver` specification\n\n1. SSH into every master node of the cluster, then complete the following steps:\n\n    **If your `kube-apiserver` is a [static pod](https://kubernetes.io/docs/tasks/configure-pod-container/static-pod/):**\n\n    1. The `azure-arc-guard-manifests` secret in the `kube-system` namespace contains two files: `guard-authn-webhook.yaml` and `guard-authz-webhook.yaml`. Copy these files to the `/etc/guard` directory of the node.\n\n        ```console\n        sudo mkdir -p /etc/guard\n        kubectl get secrets azure-arc-guard-manifests -n kube-system -o json | jq -r '.data.\"guard-authn-webhook.yaml\"' | base64 -d > /etc/guard/guard-authn-webhook.yaml\n        kubectl get secrets azure-arc-guard-manifests -n kube-system -o json | jq -r '.data.\"guard-authz-webhook.yaml\"' | base64 -d > /etc/guard/guard-authz-webhook.yaml\n        ```\n\n    1. Open the `apiserver` manifest in edit mode:\n\n       ```console\n       sudo vi /etc/kubernetes/manifests/kube-apiserver.yaml\n       ```\n\n    1. Add the following specification under `volumes`:\n\n       ```yml\n       - hostPath:\n           path: /etc/guard\n           type: Directory\n         name: azure-rbac\n       ```\n\n    1. Add the following specification under `volumeMounts`:\n\n       ```yml\n       - mountPath: /etc/guard\n         name: azure-rbac\n         readOnly: true\n       ```\n\n    **If your `kube-apiserver` isn't a static pod:**\n\n    1. Open the `apiserver` manifest in edit mode:\n\n       ```console\n       sudo vi /etc/kubernetes/manifests/kube-apiserver.yaml\n       ```\n\n    1. Add the following specification under `volumes`:\n\n       ```yml\n       - name: azure-rbac\n         secret:\n           secretName: azure-arc-guard-manifests\n       ```\n\n    1. Add the following specification under `volumeMounts`:\n\n       ```yml\n       - mountPath: /etc/guard\n         name: azure-rbac\n         readOnly: true\n       ```\n\n1. Add the following `apiserver` arguments:\n\n   ```yml\n   - --authentication-token-webhook-config-file=/etc/guard/guard-authn-webhook.yaml\n   - --authentication-token-webhook-cache-ttl=5m0s\n   - --authorization-webhook-cache-authorized-ttl=5m0s\n   - --authorization-webhook-config-file=/etc/guard/guard-authz-webhook.yaml\n   - --authorization-webhook-version=v1\n   - --authorization-mode=Node,RBAC,Webhook\n   ```\n\n   Set the following `apiserver` argument:\n\n   ```yml\n   - --authentication-token-webhook-version=v1\n   ```\n\n1. Save and close the editor to update the `apiserver` pod.",
    "file_path": "/Users/cloudchase/Desktop/Vibe_Coding/Cursor/ai-content-developer/work/tmp/azure-management-docs/articles/azure-arc/kubernetes/azure-rbac.md",
    "heading_path": [
      "Use Azure RBAC on Azure Arc-enabled Kubernetes clusters",
      "Enable Azure RBAC on the cluster",
      "Generic cluster where no reconciler is running on the `apiserver` specification"
    ],
    "section_level": 3,
    "chunk_index": 3,
    "frontmatter": {
      "title": "Azure RBAC on Azure Arc-enabled Kubernetes clusters",
      "ms.date": "02/25/2025",
      "ms.topic": "how-to",
      "ms.custom": "devx-track-azurecli",
      "description": "Use Azure RBAC for authorization checks on Azure Arc-enabled Kubernetes clusters."
    },
    "embedding_content": "Document: Azure RBAC on Azure Arc-enabled Kubernetes clusters | Topic: how-to | Description: Use Azure RBAC for authorization checks on Azure Arc-enabled Kubernetes clusters. | Section: Use Azure RBAC on Azure Arc-enabled Kubernetes clusters > Enable Azure RBAC on the cluster > Generic cluster where no reconciler is running on the `apiserver` specification | ### Generic cluster where no reconciler is running on the `apiserver` specification\n\n1. SSH into every master node of the cluster, then complete the following steps:\n\n    **If your `kube-apiserver` is a [static pod](https://kubernetes.io/docs/tasks/configure-pod-container/static-pod/):**\n\n    1. The `azure-arc-guard-manifests` secret in the `kube-system` namespace contains two files: `guard-authn-webhook.yaml` and `guard-authz-webhook.yaml`. Copy these files to the `/etc/guard` directory of the node.\n\n        ```console\n        sudo mkdir -p /etc/guard\n        kubectl get secrets azure-arc-guard-manifests -n kube-system -o json | jq -r '.data.\"guard-authn-webhook.yaml\"' | base64 -d > /etc/guard/guard-authn-webhook.yaml\n        kubectl get secrets azure-arc-guard-manifests -n kube-system -o json | jq -r '.data.\"guard-authz-webhook.yaml\"' | base64 -d > /etc/guard/guard-authz-webhook.yaml\n        ```\n\n    1. Open the `apiserver` manifest in edit mode:\n\n       ```console\n       sudo vi /etc/kubernetes/manifests/kube-apiserver.yaml\n       ```\n\n    1. Add the following specification under `volumes`:\n\n       ```yml\n       - hostPath:\n           path: /etc/guard\n           type: Directory\n         name: azure-rbac\n       ```\n\n    1. Add the following specification under `volumeMounts`:\n\n       ```yml\n       - mountPath: /etc/guard\n         name: azure-rbac\n         readOnly: true\n       ```\n\n    **If your `kube-apiserver` isn't a static pod:**\n\n    1. Open the `apiserver` manifest in edit mode:\n\n       ```console\n       sudo vi /etc/kubernetes/manifests/kube-apiserver.yaml\n       ```\n\n    1. Add the following specification under `volumes`:\n\n       ```yml\n       - name: azure-rbac\n         secret:\n           secretName: azure-arc-guard-manifests\n       ```\n\n    1. Add the following specification under `volumeMounts`:\n\n       ```yml\n       - mountPath: /etc/guard\n         name: azure-rbac\n         readOnly: true\n       ```\n\n1. Add the following `apiserver` arguments:\n\n   ```yml\n   - --authentication-token-webhook-config-file=/etc/guard/guard-authn-webhook.yaml\n   - --authentication-token-webhook-cache-ttl=5m0s\n   - --authorization-webhook-cache-authorized-ttl=5m0s\n   - --authorization-webhook-config-file=/etc/guard/guard-authz-webhook.yaml\n   - --authorization-webhook-version=v1\n   - --authorization-mode=Node,RBAC,Webhook\n   ```\n\n   Set the following `apiserver` argument:\n\n   ```yml\n   - --authentication-token-webhook-version=v1\n   ```\n\n1. Save and close the editor to update the `apiserver` pod.",
    "embedding": null,
    "embedding_model": null,
    "embedding_generated_at": null,
    "content_hash": "3e2750ab1845387f32dc4bbe2f79ef165ebd9c2233c8c3403fe046a2e9f28a8c",
    "file_id": "3e8ed022d954361887bcaeb5266dfc135ba567b5c7d7df942f9288c9158f0b00",
    "chunk_id": "80851aaac1e09e11793ecd4535f64f5f5853368227a735ca167ba471b368b5bc",
    "prev_chunk_id": "f25dfc8347647fb0f8bf83359769553fa45b852ab6b677cb0669226eab0f9745",
    "next_chunk_id": "57698475aa27bb02cc0cd9cdb2d6cc678ae28007b4b524fc8d391641c99978d8",
    "parent_heading_chunk_id": "81b8276aa06d4575b71384fc900abb381da6c007a4db269fdd9a9f8992eca7bf",
    "total_chunks_in_file": 19
  },
  "meta": {
    "type": "chunk",
    "file": "/Users/cloudchase/Desktop/Vibe_Coding/Cursor/ai-content-developer/work/tmp/azure-management-docs/articles/azure-arc/kubernetes/azure-rbac.md",
    "section": [
      "Use Azure RBAC on Azure Arc-enabled Kubernetes clusters",
      "Enable Azure RBAC on the cluster",
      "Generic cluster where no reconciler is running on the `apiserver` specification"
    ],
    "has_embedding": false
  },
  "timestamp": "2025-06-03T19:17:33.645036"
}