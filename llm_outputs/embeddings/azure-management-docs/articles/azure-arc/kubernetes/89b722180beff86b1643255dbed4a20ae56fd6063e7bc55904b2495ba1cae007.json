{
  "data": {
    "content": "### Create a user-assigned managed identity\n\nNext, create a user-assigned managed identity and give it permissions to access the Azure Key Vault. If you already have a managed identity with Key Vault Reader and Key Vault Secrets User permissions to the Azure Key Vault, you can skip this section. For more information, see [Create a user-assigned managed identities](/entra/identity/managed-identities-azure-resources/how-manage-user-assigned-managed-identities?pivots=identity-mi-methods-azp#create-a-user-assigned-managed-identity) and [Using Azure RBAC secret, key, and certificate permissions with Key Vault](/azure/key-vault/general/rbac-guide?tabs=azure-cli#using-azure-rbac-secret-key-and-certificate-permissions-with-key-vault).\n\n1. Create the user-assigned managed identity:\n\n   ```azurecli\n   az identity create --name \"${USER_ASSIGNED_IDENTITY_NAME}\" --resource-group \"${RESOURCE_GROUP}\" --location \"${LOCATION}\" --subscription \"${SUBSCRIPTION}\"\n   ```\n\n1. Give the identity Key Vault Reader and Key Vault Secrets User permissions. You may need to wait a moment for replication of the identity creation before these commands succeed:\n\n   ```azurecli\n   export USER_ASSIGNED_CLIENT_ID=\"$(az identity show --resource-group \"${RESOURCE_GROUP}\" --name \"${USER_ASSIGNED_IDENTITY_NAME}\" --query 'clientId' -otsv)\"\n   az role assignment create --role \"Key Vault Reader\" --assignee \"${USER_ASSIGNED_CLIENT_ID}\" --scope /subscriptions/${SUBSCRIPTION}/resourcegroups/${RESOURCE_GROUP}/providers/Microsoft.KeyVault/vaults/${KEYVAULT_NAME}\n   az role assignment create --role \"Key Vault Secrets User\" --assignee \"${USER_ASSIGNED_CLIENT_ID}\" --scope /subscriptions/${SUBSCRIPTION}/resourcegroups/${RESOURCE_GROUP}/providers/Microsoft.KeyVault/vaults/${KEYVAULT_NAME}\n   ```",
    "file_path": "/Users/cloudchase/Desktop/Vibe_Coding/Cursor/ai-content-developer/work/tmp/azure-management-docs/articles/azure-arc/kubernetes/secret-store-extension.md",
    "heading_path": [
      "Use the Secret Store extension to fetch secrets for offline access in Azure Arc-enabled Kubernetes clusters",
      "Create a secret and configure an identity to access it",
      "Create a user-assigned managed identity"
    ],
    "section_level": 3,
    "chunk_index": 9,
    "frontmatter": {
      "title": "Use the Azure Key Vault Secret Store extension to sync secrets to the Kubernetes secret store for offline access in Azure Arc-enabled Kubernetes clusters",
      "description": "The Azure Key Vault Secret Store extension for Kubernetes (\"SSE\") automatically synchronizes secrets from an Azure Key Vault to a Kubernetes cluster for offline access.",
      "ms.date": "09/26/2024",
      "ms.topic": "how-to",
      "ms.custom": "references_regions, ignite-2024"
    },
    "embedding_content": "Document: Use the Azure Key Vault Secret Store extension to sync secrets to the Kubernetes secret store for offline access in Azure Arc-enabled Kubernetes clusters | Topic: how-to | Description: The Azure Key Vault Secret Store extension for Kubernetes (\"SSE\") automatically synchronizes secrets | Section: Use the Secret Store extension to fetch secrets for offline access in Azure Arc-enabled Kubernetes clusters > Create a secret and configure an identity to access it > Create a user-assigned managed identity | ### Create a user-assigned managed identity\n\nNext, create a user-assigned managed identity and give it permissions to access the Azure Key Vault. If you already have a managed identity with Key Vault Reader and Key Vault Secrets User permissions to the Azure Key Vault, you can skip this section. For more information, see [Create a user-assigned managed identities](/entra/identity/managed-identities-azure-resources/how-manage-user-assigned-managed-identities?pivots=identity-mi-methods-azp#create-a-user-assigned-managed-identity) and [Using Azure RBAC secret, key, and certificate permissions with Key Vault](/azure/key-vault/general/rbac-guide?tabs=azure-cli#using-azure-rbac-secret-key-and-certificate-permissions-with-key-vault).\n\n1. Create the user-assigned managed identity:\n\n   ```azurecli\n   az identity create --name \"${USER_ASSIGNED_IDENTITY_NAME}\" --resource-group \"${RESOURCE_GROUP}\" --location \"${LOCATION}\" --subscription \"${SUBSCRIPTION}\"\n   ```\n\n1. Give the identity Key Vault Reader and Key Vault Secrets User permissions. You may need to wait a moment for replication of the identity creation before these commands succeed:\n\n   ```azurecli\n   export USER_ASSIGNED_CLIENT_ID=\"$(az identity show --resource-group \"${RESOURCE_GROUP}\" --name \"${USER_ASSIGNED_IDENTITY_NAME}\" --query 'clientId' -otsv)\"\n   az role assignment create --role \"Key Vault Reader\" --assignee \"${USER_ASSIGNED_CLIENT_ID}\" --scope /subscriptions/${SUBSCRIPTION}/resourcegroups/${RESOURCE_GROUP}/providers/Microsoft.KeyVault/vaults/${KEYVAULT_NAME}\n   az role assignment create --role \"Key Vault Secrets User\" --assignee \"${USER_ASSIGNED_CLIENT_ID}\" --scope /subscriptions/${SUBSCRIPTION}/resourcegroups/${RESOURCE_GROUP}/providers/Microsoft.KeyVault/vaults/${KEYVAULT_NAME}\n   ```",
    "embedding": null,
    "embedding_model": null,
    "embedding_generated_at": null,
    "content_hash": "29e800b05bf92d04607ad34b1d29cd4ea2cea9ec137aa7608039b30e2baf6184",
    "file_id": "5b880508d2c3419668daf37d0ffb257e9268a80b1899afb8daa2f62b08b56d1e",
    "chunk_id": "89b722180beff86b1643255dbed4a20ae56fd6063e7bc55904b2495ba1cae007",
    "prev_chunk_id": "d628a944b59156094c1f093729af42d63588c0eeb08ff542ba02341cfe6ff3d4",
    "next_chunk_id": "00a21c0c261043c82f57d9f091f493c603da434dd351932da7f1ed7632d1f850",
    "parent_heading_chunk_id": "81b6e58e1416902a2052c80fc2ea64c380efcfa320cc07c9d67385e4331ebc1a",
    "total_chunks_in_file": 29
  },
  "meta": {
    "type": "chunk",
    "file": "/Users/cloudchase/Desktop/Vibe_Coding/Cursor/ai-content-developer/work/tmp/azure-management-docs/articles/azure-arc/kubernetes/secret-store-extension.md",
    "section": [
      "Use the Secret Store extension to fetch secrets for offline access in Azure Arc-enabled Kubernetes clusters",
      "Create a secret and configure an identity to access it",
      "Create a user-assigned managed identity"
    ],
    "has_embedding": false
  },
  "timestamp": "2025-06-03T19:17:35.384909"
}