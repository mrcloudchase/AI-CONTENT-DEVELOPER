{
  "data": {
    "content": "### Helm timeout error\n\nYou may see the error `Unable to install helm release: Error: UPGRADE Failed: time out waiting for the condition`. To resolve this issue, try the following steps:\n\n1. Run the following command:\n\n    ```console\n    kubectl get pods -n azure-arc\n    ```\n\n2. Check if the `clusterconnect-agent` or the `config-agent` pods are showing `crashloopbackoff`, or if not all containers are running:\n\n    ```output\n    NAME                                        READY   STATUS             RESTARTS   AGE\n    cluster-metadata-operator-664bc5f4d-chgkl   2/2     Running            0          4m14s\n    clusterconnect-agent-7cb8b565c7-wklsh       2/3     CrashLoopBackOff   0          1m15s\n    clusteridentityoperator-76d645d8bf-5qx5c    2/2     Running            0          4m15s\n    config-agent-65d5df564f-lffqm               1/2     CrashLoopBackOff   0          1m14s\n    ```\n\n3. If the `azure-identity-certificate` isn't present, the system assigned managed identity hasn't been installed.\n\n   ```console\n   kubectl get secret -n azure-arc -o yaml | grep name:\n   ```\n\n   ```output\n   name: azure-identity-certificate\n   ```\n\n   To resolve this issue, try deleting the Arc deployment by running the `az connectedk8s delete` command and reinstalling it. If the issue continues to happen, it could be an issue with your proxy settings. In that case, [try connecting your cluster to Azure Arc via a proxy](./quickstart-connect-cluster.md#connect-using-an-outbound-proxy-server) to connect your cluster to Arc via a proxy. Also verify that all of the [network prerequisites](network-requirements.md) have been met.\n\n4. If the `clusterconnect-agent` and the `config-agent` pods are running, but the `kube-aad-proxy` pod is missing, check your pod security policies. This pod uses the `azure-arc-kube-aad-proxy-sa` service account, which doesn't have admin permissions but requires the permission to mount host path.\n\n5. If the `kube-aad-proxy` pod is stuck in `ContainerCreating` state, check whether the kube-aad-proxy certificate has been downloaded onto the cluster.\n\n   ```console\n   kubectl get secret -n azure-arc -o yaml | grep name:\n   ```\n\n   ```output\n   name: kube-aad-proxy-certificate\n   ```\n\n   If the certificate is missing, [delete the deployment](quickstart-connect-cluster.md#clean-up-resources) and try onboarding again, using a different name for the cluster. If the problem continues, [open a support request](/azure/azure-portal/supportability/how-to-create-azure-support-request).",
    "file_path": "/Users/cloudchase/Desktop/Vibe_Coding/Cursor/ai-content-developer/work/tmp/azure-management-docs/articles/azure-arc/kubernetes/troubleshooting.md",
    "heading_path": [
      "Troubleshoot platform issues for Azure Arc-enabled Kubernetes clusters",
      "Issues when connecting Kubernetes clusters to Azure Arc",
      "Helm timeout error"
    ],
    "section_level": 3,
    "chunk_index": 13,
    "frontmatter": {
      "title": "Troubleshoot platform issues for Azure Arc-enabled Kubernetes clusters",
      "ms.date": "11/01/2024",
      "ms.topic": "how-to",
      "ms.custom": "devx-track-azurecli",
      "description": "Learn how to resolve common issues with Azure Arc-enabled Kubernetes clusters and GitOps."
    },
    "embedding_content": "Document: Troubleshoot platform issues for Azure Arc-enabled Kubernetes clusters | Topic: how-to | Description: Learn how to resolve common issues with Azure Arc-enabled Kubernetes clusters and GitOps. | Section: Troubleshoot platform issues for Azure Arc-enabled Kubernetes clusters > Issues when connecting Kubernetes clusters to Azure Arc > Helm timeout error | ### Helm timeout error\n\nYou may see the error `Unable to install helm release: Error: UPGRADE Failed: time out waiting for the condition`. To resolve this issue, try the following steps:\n\n1. Run the following command:\n\n    ```console\n    kubectl get pods -n azure-arc\n    ```\n\n2. Check if the `clusterconnect-agent` or the `config-agent` pods are showing `crashloopbackoff`, or if not all containers are running:\n\n    ```output\n    NAME                                        READY   STATUS             RESTARTS   AGE\n    cluster-metadata-operator-664bc5f4d-chgkl   2/2     Running            0          4m14s\n    clusterconnect-agent-7cb8b565c7-wklsh       2/3     CrashLoopBackOff   0          1m15s\n    clusteridentityoperator-76d645d8bf-5qx5c    2/2     Running            0          4m15s\n    config-agent-65d5df564f-lffqm               1/2     CrashLoopBackOff   0          1m14s\n    ```\n\n3. If the `azure-identity-certificate` isn't present, the system assigned managed identity hasn't been installed.\n\n   ```console\n   kubectl get secret -n azure-arc -o yaml | grep name:\n   ```\n\n   ```output\n   name: azure-identity-certificate\n   ```\n\n   To resolve this issue, try deleting the Arc deployment by running the `az connectedk8s delete` command and reinstalling it. If the issue continues to happen, it could be an issue with your proxy settings. In that case, [try connecting your cluster to Azure Arc via a proxy](./quickstart-connect-cluster.md#connect-using-an-outbound-proxy-server) to connect your cluster to Arc via a proxy. Also verify that all of the [network prerequisites](network-requirements.md) have been met.\n\n4. If the `clusterconnect-agent` and the `config-agent` pods are running, but the `kube-aad-proxy` pod is missing, check your pod security policies. This pod uses the `azure-arc-kube-aad-proxy-sa` service account, which doesn't have admin permissions but requires the permission to mount host path.\n\n5. If the `kube-aad-proxy` pod is stuck in `ContainerCreating` state, check whether the kube-aad-proxy certificate has been downloaded onto the cluster.\n\n   ```console\n   kubectl get secret -n azure-arc -o yaml | grep name:\n   ```\n\n   ```output\n   name: kube-aad-proxy-certificate\n   ```\n\n   If the certificate is missing, [delete the deployment](quickstart-connect-cluster.md#clean-up-resources) and try onboarding again, using a different name for the cluster. If the problem continues, [open a support request](/azure/azure-portal/supportability/how-to-create-azure-support-request).",
    "embedding": null,
    "embedding_model": null,
    "embedding_generated_at": null,
    "content_hash": "40cc266c6abf204f12e9a8cc9e3f1571ddb87f5131457dc5283abd114f994da2",
    "file_id": "c007ccb40145633516d4c984ddfede4fe55438e19c2c208d877c65ec2144b3ee",
    "chunk_id": "46025ed08911bc89e5555abef94db859e6794f1033c1d09da927edef8a6c78da",
    "prev_chunk_id": "6abe65127a6a9ddbb1a0139a12212d13e1a411628195bef26460817217beac4d",
    "next_chunk_id": "84bb218fc9c6fb7c03bbb4142969187f4d665e77ab0bb6c5dc6460e86d87b407",
    "parent_heading_chunk_id": "8e6284c8d89012c21b57f88fba94c4f5adeb40b87673918714fa8f22e3a5c8dd",
    "total_chunks_in_file": 18
  },
  "meta": {
    "type": "chunk",
    "file": "/Users/cloudchase/Desktop/Vibe_Coding/Cursor/ai-content-developer/work/tmp/azure-management-docs/articles/azure-arc/kubernetes/troubleshooting.md",
    "section": [
      "Troubleshoot platform issues for Azure Arc-enabled Kubernetes clusters",
      "Issues when connecting Kubernetes clusters to Azure Arc",
      "Helm timeout error"
    ],
    "has_embedding": false
  },
  "timestamp": "2025-06-03T19:17:33.855923"
}