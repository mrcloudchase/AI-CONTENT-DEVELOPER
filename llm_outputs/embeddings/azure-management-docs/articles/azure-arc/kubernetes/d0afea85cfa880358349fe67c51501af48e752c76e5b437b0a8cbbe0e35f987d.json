{
  "data": {
    "content": "### Create alerts for extension and configuration failures\n\nAfter you import the dashboard as described in the previous section, you can set up alerts. These alerts notify you when Flux extensions or Flux configurations experience failures.\n\nFollow these steps to create an alert. Example queries are provided to detect extension provisioning or extension upgrade failures, or to detect compliance state failures.\n\n1. In the left navigation menu of the dashboard, select **Alerting**.\n1. Select **Alert rules**.\n1. Select **+ Create alert rule**. The new alert rule page opens, with the **Grafana managed alerts** option selected by default.\n1. In **Rule name**, add a descriptive name. This name is displayed in the alert rule list, and it's used as the `alertname` label for every alert instance created from this rule.\n1. Under **Set a query and alert condition**:\n\n   - Select a data source. The same data source used for the dashboard may be used here.\n   - For **Service**, select **Azure Resource Graph**.\n   - Select the subscriptions from the dropdown list.\n   - Enter the query you want to use. For example, for extension provisioning or upgrade failures, you can enter this query:\n\n      ```kusto\n      kubernetesconfigurationresources\n      | where type == \"microsoft.kubernetesconfiguration/extensions\"\n      | extend provisioningState = tostring(properties.ProvisioningState)\n      | where provisioningState == \"Failed\"\n      | summarize count() by provisioningState\n      ```\n\n      Or for compliance state failures, you can enter this query: \n\n      ```kusto\n      kubernetesconfigurationresources\n      | where type == \"microsoft.kubernetesconfiguration/fluxconfigurations\"\n      | extend complianceState=tostring(properties.complianceState)\n      | where complianceState == \"Non-Compliant\"\n      | summarize count() by complianceState\n      ```\n\n   - For **Threshold box**, select **A** for input type and set the threshold to **0** to receive alerts even if just one extension fails on the cluster. Mark this as the **Alert condition**.\n\n   :::image type=\"content\" source=\"media/monitor-gitops-flux2/application-dashboard-set-alerts.png\" alt-text=\"Screenshot showing the alert creation process.\" lightbox=\"media/monitor-gitops-flux2/application-dashboard-set-alerts.png\":::\n\n1. Specify the alert evaluation interval:\n\n   - For **Condition**, select the query or expression to trigger the alert rule.\n   - For **Evaluate every**, enter the evaluation frequency as a multiple of 10 seconds.\n   - For **Evaluate for**, specify how long the condition must be true before the alert is created.\n   - In **Configure no data and error handling**, indicate what should happen when the alert rule returns no data or returns an error.\n   - To check the results from running the query, select **Preview**.\n\n1. Add the storage location, rule group, and any other metadata that you want to associate with the rule.",
    "file_path": "/Users/cloudchase/Desktop/Vibe_Coding/Cursor/ai-content-developer/work/tmp/azure-management-docs/articles/azure-arc/kubernetes/monitor-gitops-flux-2.md",
    "heading_path": [
      "Monitor GitOps (Flux v2) status and activity",
      "Monitor deployment and compliance status",
      "Create alerts for extension and configuration failures"
    ],
    "section_level": 3,
    "chunk_index": 9,
    "frontmatter": {
      "title": "Monitor GitOps (Flux v2) status and activity",
      "ms.date": "02/26/2025",
      "ms.topic": "how-to",
      "description": "Learn how to monitor status, compliance, resource consumption, and reconciliation activity for GitOps with Flux v2."
    },
    "embedding_content": "Document: Monitor GitOps (Flux v2) status and activity | Topic: how-to | Description: Learn how to monitor status, compliance, resource consumption, and reconciliation activity for GitOp | Section: Monitor GitOps (Flux v2) status and activity > Monitor deployment and compliance status > Create alerts for extension and configuration failures | ### Create alerts for extension and configuration failures\n\nAfter you import the dashboard as described in the previous section, you can set up alerts. These alerts notify you when Flux extensions or Flux configurations experience failures.\n\nFollow these steps to create an alert. Example queries are provided to detect extension provisioning or extension upgrade failures, or to detect compliance state failures.\n\n1. In the left navigation menu of the dashboard, select **Alerting**.\n1. Select **Alert rules**.\n1. Select **+ Create alert rule**. The new alert rule page opens, with the **Grafana managed alerts** option selected by default.\n1. In **Rule name**, add a descriptive name. This name is displayed in the alert rule list, and it's used as the `alertname` label for every alert instance created from this rule.\n1. Under **Set a query and alert condition**:\n\n   - Select a data source. The same data source used for the dashboard may be used here.\n   - For **Service**, select **Azure Resource Graph**.\n   - Select the subscriptions from the dropdown list.\n   - Enter the query you want to use. For example, for extension provisioning or upgrade failures, you can enter this query:\n\n      ```kusto\n      kubernetesconfigurationresources\n      | where type == \"microsoft.kubernetesconfiguration/extensions\"\n      | extend provisioningState = tostring(properties.ProvisioningState)\n      | where provisioningState == \"Failed\"\n      | summarize count() by provisioningState\n      ```\n\n      Or for compliance state failures, you can enter this query: \n\n      ```kusto\n      kubernetesconfigurationresources\n      | where type == \"microsoft.kubernetesconfiguration/fluxconfigurations\"\n      | extend complianceState=tostring(properties.complianceState)\n      | where complianceState == \"Non-Compliant\"\n      | summarize count() by complianceState\n      ```\n\n   - For **Threshold box**, select **A** for input type and set the threshold to **0** to receive alerts even if just one extension fails on the cluster. Mark this as the **Alert condition**.\n\n   :::image type=\"content\" source=\"media/monitor-gitops-flux2/application-dashboard-set-alerts.png\" alt-text=\"Screenshot showing the alert creation process.\" lightbox=\"media/monitor-gitops-flux2/application-dashboard-set-alerts.png\":::\n\n1. Specify the alert evaluation interval:\n\n   - For **Condition**, select the query or expression to trigger the alert rule.\n   - For **Evaluate every**, enter the evaluation frequency as a multiple of 10 seconds.\n   - For **Evaluate for**, specify how long the condition must be true before the alert is created.\n   - In **Configure no data and error handling**, indicate what should happen when the alert rule returns no data or returns an error.\n   - To check the results from running the query, select **Preview**.\n\n1. Add the storage location, rule group, and any other metadata that you want to associate with the rule.",
    "embedding": null,
    "embedding_model": null,
    "embedding_generated_at": null,
    "content_hash": "592c955162cda9f196ff47f680f1fe3b836d91965def99dc78e5c234989d05eb",
    "file_id": "d5cf2008aa582ba87374755e0e98b830039eec148a5d6f4688b86f3444e9902e",
    "chunk_id": "d0afea85cfa880358349fe67c51501af48e752c76e5b437b0a8cbbe0e35f987d",
    "prev_chunk_id": "3ab0a4c138f596ad5e0769ff56f14b7430f9b280b0542699f2b763c18ed2856d",
    "next_chunk_id": "7541bfbd7af20f3353bf7f90a63ea6a6d005023e1740cc507f5f48717e0c9da9",
    "parent_heading_chunk_id": "16ec06e9b101470601f0dae528afab5f4e4970bc756069cb456dc48baf08b03b",
    "total_chunks_in_file": 18
  },
  "meta": {
    "type": "chunk",
    "file": "/Users/cloudchase/Desktop/Vibe_Coding/Cursor/ai-content-developer/work/tmp/azure-management-docs/articles/azure-arc/kubernetes/monitor-gitops-flux-2.md",
    "section": [
      "Monitor GitOps (Flux v2) status and activity",
      "Monitor deployment and compliance status",
      "Create alerts for extension and configuration failures"
    ],
    "has_embedding": false
  },
  "timestamp": "2025-06-03T19:17:33.745269"
}