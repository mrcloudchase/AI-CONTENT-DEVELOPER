{
  "data": {
    "content": "## Enable custom locations using service principal\n\nWhen connecting your cluster to Azure Arc or enabling custom locations on an existing cluster, you may see the following warning:\n\n```console\nUnable to fetch oid of 'custom-locations' app. Proceeding without enabling the feature. Insufficient privileges to complete the operation.\n```\n\nThis warning occurs when you use a service principal to log into Azure, and the service principal doesn't have the necessary permissions. To avoid this error, follow these steps:\n\n1. Sign in into Azure CLI using your user account. Retrieve the Object ID of the Microsoft Entra application used by Azure Arc service:\n\n    ```azurecli\n    az ad sp show --id bc313c14-388c-4e7d-a58e-70017303ee3b --query objectId -o tsv\n    ```\n\n1. Sign in into Azure CLI using the service principal. Use the `<objectId>` value from the previous step to enable custom locations on the cluster:\n\n   * To enable custom locations when connecting the cluster to Arc, run `az connectedk8s connect -n <cluster-name> -g <resource-group-name> --custom-locations-oid <objectId>`\n   * To enable custom locations on an existing Azure Arc-enabled Kubernetes cluster, run `az connectedk8s enable-features -n <cluster-name> -g <resource-group-name> --custom-locations-oid <objectId> --features cluster-connect custom-locations`",
    "file_path": "/Users/cloudchase/Desktop/Vibe_Coding/Cursor/ai-content-developer/work/tmp/azure-management-docs/articles/azure-arc/kubernetes/troubleshooting.md",
    "heading_path": [
      "Troubleshoot platform issues for Azure Arc-enabled Kubernetes clusters",
      "Enable custom locations using service principal"
    ],
    "section_level": 2,
    "chunk_index": 16,
    "frontmatter": {
      "title": "Troubleshoot platform issues for Azure Arc-enabled Kubernetes clusters",
      "ms.date": "11/01/2024",
      "ms.topic": "how-to",
      "ms.custom": "devx-track-azurecli",
      "description": "Learn how to resolve common issues with Azure Arc-enabled Kubernetes clusters and GitOps."
    },
    "embedding_content": "Document: Troubleshoot platform issues for Azure Arc-enabled Kubernetes clusters | Topic: how-to | Description: Learn how to resolve common issues with Azure Arc-enabled Kubernetes clusters and GitOps. | Section: Troubleshoot platform issues for Azure Arc-enabled Kubernetes clusters > Enable custom locations using service principal | ## Enable custom locations using service principal\n\nWhen connecting your cluster to Azure Arc or enabling custom locations on an existing cluster, you may see the following warning:\n\n```console\nUnable to fetch oid of 'custom-locations' app. Proceeding without enabling the feature. Insufficient privileges to complete the operation.\n```\n\nThis warning occurs when you use a service principal to log into Azure, and the service principal doesn't have the necessary permissions. To avoid this error, follow these steps:\n\n1. Sign in into Azure CLI using your user account. Retrieve the Object ID of the Microsoft Entra application used by Azure Arc service:\n\n    ```azurecli\n    az ad sp show --id bc313c14-388c-4e7d-a58e-70017303ee3b --query objectId -o tsv\n    ```\n\n1. Sign in into Azure CLI using the service principal. Use the `<objectId>` value from the previous step to enable custom locations on the cluster:\n\n   * To enable custom locations when connecting the cluster to Arc, run `az connectedk8s connect -n <cluster-name> -g <resource-group-name> --custom-locations-oid <objectId>`\n   * To enable custom locations on an existing Azure Arc-enabled Kubernetes cluster, run `az connectedk8s enable-features -n <cluster-name> -g <resource-group-name> --custom-locations-oid <objectId> --features cluster-connect custom-locations`",
    "embedding": null,
    "embedding_model": null,
    "embedding_generated_at": null,
    "content_hash": "a444bcc5f5a7ee43a08961d8b484d3be4246c72d1606500bef23a76deb2a6c20",
    "file_id": "c007ccb40145633516d4c984ddfede4fe55438e19c2c208d877c65ec2144b3ee",
    "chunk_id": "396254287607782807c6680688684076b2de3608782fbeb345de7efbf3b480e1",
    "prev_chunk_id": "814cc4c8bf3ec0569332242d15ad3189588bd426d73056142b0f86d590f8f144",
    "next_chunk_id": "07ef2013377d48498a0cb2634a89126383ab3e96e12dda2029fbe4d31eaa2e78",
    "parent_heading_chunk_id": "1ccf38c17f89c46c57311c1dc4bd04f32a3706d68eaddd9fb85b84351ac8a8ca",
    "total_chunks_in_file": 18
  },
  "meta": {
    "type": "chunk",
    "file": "/Users/cloudchase/Desktop/Vibe_Coding/Cursor/ai-content-developer/work/tmp/azure-management-docs/articles/azure-arc/kubernetes/troubleshooting.md",
    "section": [
      "Troubleshoot platform issues for Azure Arc-enabled Kubernetes clusters",
      "Enable custom locations using service principal"
    ],
    "has_embedding": false
  },
  "timestamp": "2025-06-03T19:17:33.860138"
}