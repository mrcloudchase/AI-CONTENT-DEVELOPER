{
  "data": {
    "content": "## Monitoring application using Azure Monitor and Applications Insights (preview)\n\nBoth Azure Monitor and Azure Application Insights help you maximize the availability and performance of your applications and services by delivering a comprehensive solution for collecting, analyzing, and acting on telemetry from your cloud and on-premises environments. Azure Arc-enabled Open Service Mesh has deep integrations into both of these Azure services. This integration provides a seamless Azure experience for viewing and responding to critical KPIs provided by OSM metrics.\n\n[!INCLUDE [preview features note](./includes/preview/preview-callout.md)]\n\nFollow these steps to allow Azure Monitor to scrape Prometheus endpoints for collecting application metrics.\n\n1. Follow the guidance available [here](#onboard-namespaces-to-the-service-mesh) to ensure that the application namespaces that you wish to be monitored are onboarded to the mesh.\n\n2. Expose the Prometheus endpoints for application namespaces.\n\n   ```azurecli-interactive\n   osm metrics enable --namespace <namespace1>\n   osm metrics enable --namespace <namespace2>\n   ```\n\n3. Install the Azure Monitor extension using the guidance available [here](/azure/azure-monitor/containers/container-insights-enable-arc-enabled-clusters?toc=/azure/azure-arc/kubernetes/toc.json).\n\n4. Create a Configmap in the `kube-system` namespace that enables Azure Monitor to monitor your namespaces. For example, create a `container-azm-ms-osmconfig.yaml` with the following to monitor `<namespace1>` and `<namespace2>`:\n\n      ```yaml\n      kind: ConfigMap\n      apiVersion: v1\n      data:\n        schema-version: v1\n        config-version: ver1\n        osm-metric-collection-configuration: |-\n          # OSM metric collection settings\n          [osm_metric_collection_configuration]\n            [osm_metric_collection_configuration.settings]\n                # Namespaces to monitor\n                monitor_namespaces = [\"<namespace1>\", \"<namespace2>\"]\n      metadata:\n        name: container-azm-ms-osmconfig\n        namespace: kube-system\n      ```\n\n5. Run the following kubectl command\n\n    ```azurecli-interactive\n    kubectl apply -f container-azm-ms-osmconfig.yaml\n    ```\n\nIt may take up to 15 minutes for the metrics to show up in Log Analytics. You can try querying the InsightsMetrics table.\n\n```azurecli-interactive\nInsightsMetrics\n| where Name contains \"envoy\"\n| extend t=parse_json(Tags)\n| where t.app == \"namespace1\"\n```",
    "file_path": "/Users/cloudchase/Desktop/Vibe_Coding/Cursor/ai-content-developer/work/tmp/azure-management-docs/articles/azure-arc/kubernetes/tutorial-arc-enabled-open-service-mesh.md",
    "heading_path": [
      "Validations on the CRD will deny this change",
      "Monitoring application using Azure Monitor and Applications Insights (preview)"
    ],
    "section_level": 2,
    "chunk_index": 24,
    "frontmatter": {
      "title": "Azure Arc-enabled Open Service Mesh",
      "description": "Deploy the Open Service Mesh (OSM) extension on Azure Arc-enabled Kubernetes cluster",
      "ms.custom": "devx-track-azurecli, devx-track-arm-template",
      "ms.date": "02/26/2025",
      "ms.topic": "tutorial"
    },
    "embedding_content": "Document: Azure Arc-enabled Open Service Mesh | Topic: tutorial | Description: Deploy the Open Service Mesh (OSM) extension on Azure Arc-enabled Kubernetes cluster | Section: Validations on the CRD will deny this change > Monitoring application using Azure Monitor and Applications Insights (preview) | ## Monitoring application using Azure Monitor and Applications Insights (preview)\n\nBoth Azure Monitor and Azure Application Insights help you maximize the availability and performance of your applications and services by delivering a comprehensive solution for collecting, analyzing, and acting on telemetry from your cloud and on-premises environments. Azure Arc-enabled Open Service Mesh has deep integrations into both of these Azure services. This integration provides a seamless Azure experience for viewing and responding to critical KPIs provided by OSM metrics.\n\n[!INCLUDE [preview features note](./includes/preview/preview-callout.md)]\n\nFollow these steps to allow Azure Monitor to scrape Prometheus endpoints for collecting application metrics.\n\n1. Follow the guidance available [here](#onboard-namespaces-to-the-service-mesh) to ensure that the application namespaces that you wish to be monitored are onboarded to the mesh.\n\n2. Expose the Prometheus endpoints for application namespaces.\n\n   ```azurecli-interactive\n   osm metrics enable --namespace <namespace1>\n   osm metrics enable --namespace <namespace2>\n   ```\n\n3. Install the Azure Monitor extension using the guidance available [here](/azure/azure-monitor/containers/container-insights-enable-arc-enabled-clusters?toc=/azure/azure-arc/kubernetes/toc.json).\n\n4. Create a Configmap in the `kube-system` namespace that enables Azure Monitor to monitor your namespaces. For example, create a `container-azm-ms-osmconfig.yaml` with the following to monitor `<namespace1>` and `<namespace2>`:\n\n      ```yaml\n      kind: ConfigMap\n      apiVersion: v1\n      data:\n        schema-version: v1\n        config-version: ver1\n        osm-metric-collection-configuration: |-\n          # OSM metric collection settings\n          [osm_metric_collection_configuration]\n            [osm_metric_collection_configuration.settings]\n                # Namespaces to monitor\n                monitor_namespaces = [\"<namespace1>\", \"<namespace2>\"]\n      metadata:\n        name: container-azm-ms-osmconfig\n        namespace: kube-system\n      ```\n\n5. Run the following kubectl command\n\n    ```azurecli-interactive\n    kubectl apply -f container-azm-ms-osmconfig.yaml\n    ```\n\nIt may take up to 15 minutes for the metrics to show up in Log Analytics. You can try querying the InsightsMetrics table.\n\n```azurecli-interactive\nInsightsMetrics\n| where Name contains \"envoy\"\n| extend t=parse_json(Tags)\n| where t.app == \"namespace1\"\n```",
    "embedding": null,
    "embedding_model": null,
    "embedding_generated_at": null,
    "content_hash": "0a6e86697e0f05091111f1094183e5005987c71dac95c9e250b0bf35dc541b3f",
    "file_id": "a6312c23163d816412bf1493f1bb69ddd4c48032210eac11838910dad4c630ad",
    "chunk_id": "8bae5f8f8afbb00deb05e1f9be0f75111a6973d9333c989556e8456746d15fc5",
    "prev_chunk_id": "ee5b710ac4b996a983efe4137d3c0be57e040cf6e3e9d6ba85f7eb080df966c3",
    "next_chunk_id": "06c428288e68c14bcc3f43b81501c42e3b9b010dbc41b9beaaaaac7406134b91",
    "parent_heading_chunk_id": "f00b151cc4cfd00cfe2e8e8e20f7217baf3ae29b9a5dfc05a3559f5709ea0038",
    "total_chunks_in_file": 34
  },
  "meta": {
    "type": "chunk",
    "file": "/Users/cloudchase/Desktop/Vibe_Coding/Cursor/ai-content-developer/work/tmp/azure-management-docs/articles/azure-arc/kubernetes/tutorial-arc-enabled-open-service-mesh.md",
    "section": [
      "Validations on the CRD will deny this change",
      "Monitoring application using Azure Monitor and Applications Insights (preview)"
    ],
    "has_embedding": false
  },
  "timestamp": "2025-06-03T19:17:35.639306"
}